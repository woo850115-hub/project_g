{"version":3,"file":"GifAsset.js","sources":["../../src/gif/GifAsset.ts"],"sourcesContent":["import { DOMAdapter } from '../environment/adapter';\nimport { ExtensionType } from '../extensions/Extensions';\nimport { path } from '../utils/path';\nimport { type GifBufferOptions, GifSource } from './GifSource';\n\nimport type { AssetExtension } from '../assets/AssetExtension';\n\n/**\n * Handle the loading of GIF images. Registering this loader plugin will\n * load all `.gif` images as an ArrayBuffer and transform into an\n * GifSource object.\n * @category gif\n * @advanced\n */\nconst GifAsset: AssetExtension<GifSource, GifBufferOptions> = {\n    extension: ExtensionType.Asset,\n    detection: {\n        test: async () => true,\n        add: async (formats) => [...formats, 'gif'],\n        remove: async (formats) => formats.filter((format) => format !== 'gif'),\n    },\n    loader: {\n        /** used for deprecation purposes */\n        name: 'gifLoader',\n        id: 'gif',\n        test: (url) => path.extname(url) === '.gif' || url.startsWith('data:image/gif'),\n        load: async (url, asset) =>\n        {\n            const response = await DOMAdapter.get().fetch(url);\n            const buffer = await response.arrayBuffer();\n\n            return GifSource.from(buffer, asset?.data);\n        },\n        unload: async (asset) =>\n        {\n            asset.destroy();\n        },\n    }\n};\n\nexport { GifAsset };\n"],"names":["ExtensionType","path","DOMAdapter","GifSource"],"mappings":";;;;;;;;AAcA,MAAM,QAAA,GAAwD;AAAA,EAC1D,WAAWA,wBAAA,CAAc,KAAA;AAAA,EACzB,SAAA,EAAW;AAAA,IACP,MAAM,YAAY,IAAA;AAAA,IAClB,KAAK,OAAO,OAAA,KAAY,CAAC,GAAG,SAAS,KAAK,CAAA;AAAA,IAC1C,MAAA,EAAQ,OAAO,OAAA,KAAY,OAAA,CAAQ,OAAO,CAAC,MAAA,KAAW,WAAW,KAAK;AAAA,GAC1E;AAAA,EACA,MAAA,EAAQ;AAAA;AAAA,IAEJ,IAAA,EAAM,WAAA;AAAA,IACN,EAAA,EAAI,KAAA;AAAA,IACJ,IAAA,EAAM,CAAC,GAAA,KAAQC,SAAA,CAAK,OAAA,CAAQ,GAAG,CAAA,KAAM,MAAA,IAAU,GAAA,CAAI,UAAA,CAAW,gBAAgB,CAAA;AAAA,IAC9E,IAAA,EAAM,OAAO,GAAA,EAAK,KAAA,KAClB;AACI,MAAA,MAAM,WAAW,MAAMC,kBAAA,CAAW,GAAA,EAAI,CAAE,MAAM,GAAG,CAAA;AACjD,MAAA,MAAM,MAAA,GAAS,MAAM,QAAA,CAAS,WAAA,EAAY;AAE1C,MAAA,OAAOC,mBAAA,CAAU,IAAA,CAAK,MAAA,EAAQ,KAAA,EAAO,IAAI,CAAA;AAAA,IAC7C,CAAA;AAAA,IACA,MAAA,EAAQ,OAAO,KAAA,KACf;AACI,MAAA,KAAA,CAAM,OAAA,EAAQ;AAAA,IAClB;AAAA;AAER;;;;"}
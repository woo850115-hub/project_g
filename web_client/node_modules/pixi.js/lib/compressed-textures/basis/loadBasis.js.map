{"version":3,"file":"loadBasis.js","sources":["../../../src/compressed-textures/basis/loadBasis.ts"],"sourcesContent":["import { LoaderParserPriority } from '../../assets/loader/parsers/LoaderParser';\nimport { createTexture } from '../../assets/loader/parsers/textures/utils/createTexture';\nimport { checkExtension } from '../../assets/utils/checkExtension';\nimport { ExtensionType } from '../../extensions/Extensions';\nimport { CompressedSource } from '../../rendering/renderers/shared/texture/sources/CompressedSource';\nimport { getSupportedTextureFormats } from '../../rendering/renderers/shared/texture/utils/getSupportedTextureFormats';\nimport { loadBasisOnWorker } from './worker/loadBasisOnWorker';\n\nimport type { Loader } from '../../assets/loader/Loader';\nimport type { LoaderParser } from '../../assets/loader/parsers/LoaderParser';\nimport type { ResolvedAsset } from '../../assets/types';\nimport type { TextureSourceOptions } from '../../rendering/renderers/shared/texture/sources/TextureSource';\nimport type { Texture } from '../../rendering/renderers/shared/texture/Texture';\n\n/**\n * Loads Basis textures using a web worker.\n * @category assets\n * @advanced\n */\nexport const loadBasis = {\n    extension: {\n        type: ExtensionType.LoadParser,\n        priority: LoaderParserPriority.High,\n        name: 'loadBasis',\n    },\n\n    /** used for deprecation purposes */\n    name: 'loadBasis',\n    id: 'basis',\n\n    test(url: string): boolean\n    {\n        return checkExtension(url, ['.basis']);\n    },\n\n    async load(url: string, _asset: ResolvedAsset, loader: Loader): Promise<Texture | Texture[]>\n    {\n        const supportedTextures = await getSupportedTextureFormats();\n\n        const textureOptions = await loadBasisOnWorker(url, supportedTextures);\n\n        const compressedTextureSource = new CompressedSource(textureOptions);\n\n        return createTexture(compressedTextureSource, loader, url);\n    },\n\n    unload(texture: Texture | Texture[]): void\n    {\n        if (Array.isArray(texture))\n        {\n            texture.forEach((t) => t.destroy(true));\n        }\n        else\n        {\n            texture.destroy(true);\n        }\n    }\n\n} satisfies LoaderParser<Texture | Texture[], TextureSourceOptions>;\n"],"names":["ExtensionType","LoaderParserPriority","checkExtension","getSupportedTextureFormats","loadBasisOnWorker","CompressedSource","createTexture"],"mappings":";;;;;;;;;;;AAmBO,MAAM,SAAA,GAAY;AAAA,EACrB,SAAA,EAAW;AAAA,IACP,MAAMA,wBAAA,CAAc,UAAA;AAAA,IACpB,UAAUC,iCAAA,CAAqB,IAAA;AAAA,IAC/B,IAAA,EAAM;AAAA,GACV;AAAA;AAAA,EAGA,IAAA,EAAM,WAAA;AAAA,EACN,EAAA,EAAI,OAAA;AAAA,EAEJ,KAAK,GAAA,EACL;AACI,IAAA,OAAOC,6BAAA,CAAe,GAAA,EAAK,CAAC,QAAQ,CAAC,CAAA;AAAA,EACzC,CAAA;AAAA,EAEA,MAAM,IAAA,CAAK,GAAA,EAAa,MAAA,EAAuB,MAAA,EAC/C;AACI,IAAA,MAAM,iBAAA,GAAoB,MAAMC,qDAAA,EAA2B;AAE3D,IAAA,MAAM,cAAA,GAAiB,MAAMC,mCAAA,CAAkB,GAAA,EAAK,iBAAiB,CAAA;AAErE,IAAA,MAAM,uBAAA,GAA0B,IAAIC,iCAAA,CAAiB,cAAc,CAAA;AAEnE,IAAA,OAAOC,2BAAA,CAAc,uBAAA,EAAyB,MAAA,EAAQ,GAAG,CAAA;AAAA,EAC7D,CAAA;AAAA,EAEA,OAAO,OAAA,EACP;AACI,IAAA,IAAI,KAAA,CAAM,OAAA,CAAQ,OAAO,CAAA,EACzB;AACI,MAAA,OAAA,CAAQ,QAAQ,CAAC,CAAA,KAAM,CAAA,CAAE,OAAA,CAAQ,IAAI,CAAC,CAAA;AAAA,IAC1C,CAAA,MAEA;AACI,MAAA,OAAA,CAAQ,QAAQ,IAAI,CAAA;AAAA,IACxB;AAAA,EACJ;AAEJ;;;;"}